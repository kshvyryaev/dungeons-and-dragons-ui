<h1 mat-dialog-title>Создание персонажа</h1>

<div mat-dialog-content class="dialog-content">
  <mat-vertical-stepper [linear]="true" #stepper>
    
    <mat-step [stepControl]="firstStepForm">
      <app-character-name-form
        [formGroup]="firstStepForm" [(name)]="character.name">
      </app-character-name-form>

      <div class="form-button-container">
        <button class="form-button_margin" mat-button (click)="cancel()">Отмена</button>
        <button class="form-button_margin" mat-raised-button color="primary" matStepperNext>Далее</button>
      </div>
    </mat-step>

    <mat-step [stepControl]="secondStepForm">
      <app-character-game-state-form
        [formGroup]="secondStepForm" [(gameState)]="character.gameState">
      </app-character-game-state-form>

      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step [stepControl]="thirdStepForm">
      <app-character-description-form
        [formGroup]="thirdStepForm" [(characterDescription)]="character.characterDescription">
      </app-character-description-form>

      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>
    
    <mat-step [stepControl]="fourthStepForm">
      <app-character-characteristics-form
        [formGroup]="fourthStepForm"
        [(characteristics)]="character.characteristics"
        [(inspiration)]="character.inspiration"
        [(proficiencyBonus)]="character.proficiencyBonus"
        [(passiveWisdom)]="character.passiveWisdom">
      </app-character-characteristics-form>

      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step [stepControl]="fifthStepForm">
      <app-character-skills-form
        [formGroup]="fifthStepForm" [(skills)]="character.skills">
      </app-character-skills-form>

      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step [stepControl]="sixthStepForm">
      <form [formGroup]="sixthStepForm">
        <ng-template matStepLabel>Физическое состояние</ng-template>
        <div class="form-field-container">
          <mat-form-field class="form-field">
            <input matInput placeholder="Класс доспеха" type="number" formControlName="armorClass"
              [(ngModel)]="character.physicalState.armorClass" required>
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Инициатива" type="number" formControlName="initiative"
              [(ngModel)]="character.physicalState.initiative" required>
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Скорость" type="number" formControlName="speed"
              [(ngModel)]="character.physicalState.speed" required>
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Максимальное здоровье" type="number" formControlName="maxHitPoints"
              [(ngModel)]="character.physicalState.maxHitPoints" required>
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Текущее зоровье" type="number" formControlName="currentHitPoints"
              [(ngModel)]="character.physicalState.currentHitPoints">
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Временное здоровье" type="number" formControlName="temporaryHitPoints"
              [(ngModel)]="character.physicalState.temporaryHitPoints">
          </mat-form-field>

          <mat-form-field class="form-field">
            <input matInput placeholder="Тип костей очков здоровья" formControlName="hitDiceType"
              [(ngModel)]="character.physicalState.hitDice.type" required>
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Число костей очков здоровья" type="number" formControlName="hitDiceTotal"
              [(ngModel)]="character.physicalState.hitDice.total" required>
          </mat-form-field>

          <mat-form-field class="form-field">
            <input matInput placeholder="Число успешных бросков" type="number" formControlName="successes"
              [(ngModel)]="character.physicalState.deathSaves.successes">
          </mat-form-field>
          <mat-form-field class="form-field">
            <input matInput placeholder="Число неудачных бросков" type="number" formControlName="failures"
              [(ngModel)]="character.physicalState.deathSaves.failures">
          </mat-form-field>
        </div>
      </form>
      
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавлние атак</ng-template>
      <app-attacks-table-container [attacks]="character.attacks"></app-attacks-table-container>
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавлние навыков</ng-template>
      <app-proficiencies-table-container
        [proficiencies]="character.proficiencies">
      </app-proficiencies-table-container>
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавлние языков</ng-template>
      <app-strings-table-container
        [elements]="character.languages"
        [addStringDialogTitle]="LANGUAGES_ADD_STRING_DIALOG_TITLE">
      </app-strings-table-container>
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавлние особенностей</ng-template>
      <app-strings-table-container
        [elements]="character.features"
        [addStringDialogTitle]="FEATURES_ADD_STRING_DIALOG_TITLE">
      </app-strings-table-container>
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавлние снаряжения</ng-template>
      <app-equipment-table-container
        [equipment]="character.equipment">
      </app-equipment-table-container>
      <app-stepper-middle-buttons (onCanceled)="cancel()"></app-stepper-middle-buttons>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Добавление</ng-template>
      <div class="form-button-container">
        <button class="form-button_margin" mat-button (click)="cancel()">Отмена</button>
        <button class="form-button_margin" mat-button matStepperPrevious>Назад</button>
        <button class="form-button_margin" mat-raised-button color="primary"
          (click)="addCharacter()" [disabled]="!availabeToAddCharacter()">Добавить</button>
      </div>
    </mat-step>

  </mat-vertical-stepper>
</div>